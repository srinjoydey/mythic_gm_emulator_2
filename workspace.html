from PySide6.QtWidgets import QWidget, QLabel, QPushButton, QGridLayout, QScrollArea, QVBoxLayout
from PySide6.QtGui import QFont, QIcon
from PySide6.QtCore import Qt
from views.new_story import NewStoryView  # Import to navigate back

class ScrollCheckUI(QWidget):
    """UI Layout with both horizontal and vertical scrolling."""
    def __init__(self, parent, controller):
        super().__init__(parent)
        self.controller = controller

        # Apply plain white background
        self.setStyleSheet("background-color: white;")

        # **Main Layout (Non-Scrollable)**
        self.layout = QVBoxLayout(self)
        self.layout.setContentsMargins(0, 0, 0, 0)  # Keep margins fixed

        # **Create Transparent Container for Close Button Row**
        close_row_container = QWidget(self)
        close_row_container.setStyleSheet("background-color: transparent;")

        # **Add Close Button Inside Transparent Container**
        close_button = QPushButton(close_row_container)
        close_button.setIcon(QIcon("assets/icons/close_icon.png"))
        close_button.setFont(QFont("Arial", 14, QFont.Bold))
        close_button.setStyleSheet("""
            padding: 10px;
            background-color: transparent;
            color: maroon;
            border: 2px solid black;
        """)
        close_button.clicked.connect(lambda: self.controller.show_view(NewStoryView))

        # **Add Close Button to Transparent Container**
        close_row_layout = QVBoxLayout(close_row_container)
        close_row_layout.addWidget(close_button, alignment=Qt.AlignCenter)

        # **Add Transparent Row to Main Layout**
        self.layout.addWidget(close_row_container)

        # **Create a Container for the Table (Adds Left & Right Margins)**
        table_container = QWidget(self)
        table_container_layout = QVBoxLayout(table_container)
        table_container_layout.setContentsMargins(50, 0, 50, 0)  # Adds space on left & right

        # **Create Scroll Area**
        scroll_area = QScrollArea(table_container)
        scroll_area.setWidgetResizable(True)
        scroll_area.setVerticalScrollBarPolicy(Qt.ScrollBarAlwaysOn)
        scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOn)

        # **Create Scrollable Content Widget**
        scroll_widget = QWidget()
        scroll_layout = QGridLayout(scroll_widget)
        scroll_layout.setSpacing(0)

        # Define section labels (spanning 5 rows each)
        section_labels = ["1 - 2", "3 - 4", "5 - 6", "7 - 8", "9 - 10"]

        # Create table structure
        row_index = 0
        for section_label in section_labels:
            # **Section Label (Spans 5 Rows, 2 Columns)**
            section_label_widget = QLabel(section_label, scroll_widget)
            section_label_widget.setFont(QFont("Arial", 14, QFont.Bold))
            section_label_widget.setAlignment(Qt.AlignCenter)
            section_label_widget.setStyleSheet("""
                border: 2px solid black;
                padding: 5px;
                background-color: white;
                color: black;
                font-weight: bold;
            """)
            scroll_layout.addWidget(section_label_widget, row_index, 0, 5, 2)

            # **Row Labels & Table Cells**
            for i in range(5):
                border_bottom = "2px solid black" if i == 4 else "1px solid black"

                row_label = QLabel(section_labels[i], scroll_widget)
                row_label.setFont(QFont("Arial", 12, QFont.Bold))
                row_label.setAlignment(Qt.AlignCenter)
                row_label.setStyleSheet(f"""
                    border: 2px solid black;
                    padding: 5px;
                    background-color: white;
                    color: black;
                    font-weight: bold;
                """)
                scroll_layout.addWidget(row_label, row_index, 2, 1, 2)

                table_cell = QLabel("", scroll_widget)
                table_cell.setStyleSheet(f"""
                    border: 2px solid black;
                    padding: 10px;
                    background-color: white;
                """)
                scroll_layout.addWidget(table_cell, row_index, 4, 1, 8)

                row_index += 1

        # **Set Scrollable Widget Inside Scroll Area**
        scroll_area.setWidget(scroll_widget)

        # **Add Scroll Area to Table Container**
        table_container_layout.addWidget(scroll_area)

        # **Add Table Container to Main Layout**
        self.layout.addWidget(table_container)

        self.setLayout(self.layout)  # Ensure full layout usage
